<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title id="siteTitle">Nexora Hub | Omni</title>
<link id="siteIcon" rel="icon" href="https://www.google.com/favicon.ico">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600&family=Orbitron:wght@400;700&family=JetBrains+Mono:wght@400&display=swap" rel="stylesheet">
<style>
:root {
--bg: #030303;
--accent: #00f2ff;
--sec-accent: #ff0055;
--text: #ffffff;
--panel-bg: rgba(5,5,5,0.92);
--glow: 0 0 20px rgba(0, 242, 255, 0.3);
--box-size: 130px;
--grid-gap: 20px;
--glass-blur: 12px;
--cursor-size: 10px;
--grid-cols: 5;
--radius: 16px;
--font-main: 'Plus Jakarta Sans', sans-serif;
--font-tech: 'Orbitron', monospace;
--font-mono: 'JetBrains Mono', monospace;
}

/* Core Setup */
* { box-sizing: border-box; outline: none; user-select: none; scrollbar-width: thin; scrollbar-color: var(--accent) #111; }
body {
margin: 0; height: 100vh; background: var(--bg); color: var(--text);
font-family: var(--font-main); overflow: hidden;
background-size: cover; background-position: center; transition: background 0.5s;
}

/* Custom Cursor */
body.custom-cursor * { cursor: none !important; }
#cursor { position: fixed; pointer-events: none; z-index: 9999; transform: translate(-50%, -50%); display: none; mix-blend-mode: difference; }
#cursor.active { display: block; }
#cursor .dot { width: var(--cursor-size); height: var(--cursor-size); background: var(--accent); border-radius: 50%; box-shadow: var(--glow); }
#cursor .ring { position: absolute; top:50%; left:50%; transform:translate(-50%, -50%); width: 35px; height: 35px; border: 1px solid var(--accent); border-radius: 50%; opacity: 0.5; transition: 0.15s; }

/* Background Overlays */
#particleCanvas { position: fixed; inset: 0; z-index: 1; pointer-events: none; }
.vignette { position: fixed; inset: 0; pointer-events: none; z-index: 2; background: radial-gradient(circle, transparent 40%, black 145%); }
.scanline { position: fixed; inset: 0; z-index: 9000; pointer-events: none; background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0) 50%, rgba(0,0,0,0.2) 50%, rgba(0,0,0,0.2)); background-size: 100% 4px; display: none; }
.scanline.active { display: block; }

/* Navigation */
.tab-bar { position: fixed; top: 0; left: 50%; transform: translateX(-50%); display: flex; gap: 10px; padding: 12px 25px; z-index: 100; background: rgba(0,0,0,0.65); backdrop-filter: blur(15px); border-radius: 0 0 25px 25px; border: 1px solid rgba(255,255,255,0.08); border-top: none; box-shadow: 0 10px 30px rgba(0,0,0,0.6); }
.tab { padding: 8px 25px; border-radius: 20px; font-family: var(--font-tech); font-size: 10px; color: #888; transition: 0.3s; cursor: pointer; border: 1px solid transparent; background: transparent; text-transform: uppercase; letter-spacing: 2px; }
.tab:hover { color: #fff; }
.tab.active { color: var(--accent); background: rgba(255,255,255,0.05); border-color: rgba(255,255,255,0.1); box-shadow: var(--glow); }

/* Views & Content */
.view { position: absolute; inset: 0; display: none; padding-top: 100px; z-index: 10; flex-direction: column; align-items: center; }
.view.active { display: flex; animation: fadeUp 0.4s cubic-bezier(0.2, 0.8, 0.2, 1); }
@keyframes fadeUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

/* Search Bar */
.search-container { position: relative; margin-bottom: 25px; width: 450px; max-width: 90%; z-index: 20; }
.search-bar { width: 100%; background: rgba(0,0,0,0.6); border: 1px solid rgba(255,255,255,0.1); padding: 14px 45px; border-radius: 35px; color: white; font-family: var(--font-mono); font-size: 13px; backdrop-filter: blur(10px); transition: 0.3s; }
.search-bar:focus { border-color: var(--accent); box-shadow: 0 0 20px var(--glow); width: 105%; transform: translateX(-2.5%); }
.search-icon { position: absolute; left: 18px; top: 50%; transform: translateY(-50%); color: var(--accent); opacity: 0.6; font-size: 14px; }

/* Grid */
.grid-container { overflow-y: auto; max-height: 75vh; width: 100%; display: flex; flex-direction: column; align-items: center; padding-bottom: 60px; }
.grid { display: grid; grid-template-columns: repeat(var(--grid-cols), var(--box-size)); gap: var(--grid-gap); padding: 20px; }

.box {
position: relative; width: var(--box-size); height: var(--box-size);
background: rgba(255,255,255,0.03); backdrop-filter: blur(var(--glass-blur));
border: 1px solid rgba(255,255,255,0.08); border-radius: var(--radius);
display: flex; flex-direction: column; justify-content: center; align-items: center;
text-decoration: none; transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1); overflow: hidden;
}
.box:hover { border-color: var(--accent); transform: translateY(-8px) scale(1.05); box-shadow: var(--glow); background: rgba(255,255,255,0.08); z-index: 5; }
.box i { font-size: 30px; color: #ccc; margin-bottom: 12px; transition: 0.3s; filter: drop-shadow(0 0 5px rgba(0,0,0,0.5)); }
.box:hover i { color: var(--accent); transform: scale(1.15); filter: drop-shadow(0 0 8px var(--accent)); }
.box span { font-size: 11px; font-weight: 600; letter-spacing: 0.5px; color: #fff; text-align: center; opacity: 0.8; font-family: var(--font-main); }

.del-btn { position: absolute; top: 8px; right: 8px; color: #ff4444; font-size: 12px; cursor: pointer; opacity: 0; transition: 0.2s; z-index: 10; padding: 5px; }
.box:hover .del-btn { opacity: 0.6; }
.del-btn:hover { opacity: 1 !important; transform: scale(1.2); }

/* Widgets */
.widget-area { position: fixed; top: 25px; right: 35px; text-align: right; z-index: 50; display: flex; flex-direction: column; gap: 4px; pointer-events: none; text-shadow: 0 2px 10px rgba(0,0,0,0.8); }
.clock { font-family: var(--font-tech); font-size: 34px; color: var(--text); font-weight: 700; letter-spacing: 1px; }
.date { font-size: 11px; color: var(--accent); letter-spacing: 2px; text-transform: uppercase; font-weight: 600; }
.greeting { font-family: var(--font-main); font-size: 14px; color: #aaa; font-weight: 300; }
.sys-stat { font-family: var(--font-mono); font-size: 10px; color: var(--sec-accent); margin-top: 6px; background: rgba(0,0,0,0.5); padding: 5px 12px; border-radius: 6px; border: 1px solid rgba(255,255,255,0.08); display: none; }

/* Sidebar & Config */
.sidebar-btn { position: fixed; bottom: 25px; right: 25px; z-index: 200; font-size: 20px; color: var(--text); background: rgba(15,15,15,0.7); padding: 16px; border-radius: 50%; backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); cursor: pointer; transition: 0.4s; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
.sidebar-btn:hover { color: var(--accent); border-color: var(--accent); transform: rotate(180deg); box-shadow: 0 0 25px var(--glow); }

.sidebar {
position: fixed; top: 0; right: -420px; width: 400px; height: 100%;
background: var(--panel-bg); backdrop-filter: blur(45px); z-index: 5000;
padding: 0; transition: 0.5s cubic-bezier(0.2, 0.8, 0.2, 1);
border-left: 1px solid rgba(255,255,255,0.1); display: flex; flex-direction: column;
}
.sidebar.open { right: 0; box-shadow: -50px 0 100px rgba(0,0,0,0.9); }
.sb-header { padding: 30px; border-bottom: 1px solid rgba(255,255,255,0.05); display: flex; justify-content: space-between; align-items: center; background: rgba(255,255,255,0.02); }
.sb-title { font-family: var(--font-tech); font-size: 18px; color: var(--accent); letter-spacing: 3px; }
.sb-content { flex-grow: 1; overflow-y: auto; padding: 25px; }

details { margin-bottom: 15px; border: 1px solid rgba(255,255,255,0.06); border-radius: 12px; overflow: hidden; background: rgba(0,0,0,0.3); }
summary { padding: 15px; cursor: pointer; font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 1.5px; color: #888; transition: 0.2s; list-style: none; display: flex; justify-content: space-between; align-items: center; }
summary:hover { color: #fff; background: rgba(255,255,255,0.03); }
summary::after { content: '\f107'; font-family: 'Font Awesome 6 Free'; font-weight: 900; transition: 0.3s; }
details[open] summary::after { transform: rotate(180deg); color: var(--accent); }

.control-group { padding: 18px; display: flex; flex-direction: column; gap: 14px; border-top: 1px solid rgba(255,255,255,0.05); }
.row { display: flex; justify-content: space-between; align-items: center; font-size: 11px; color: #999; }

/* Elements */
input[type="text"], input[type="url"], input[type="number"], select { background: #111; border: 1px solid #333; color: white; padding: 10px; border-radius: 8px; font-size: 11px; width: 100%; font-family: var(--font-main); transition: 0.2s; }
input:focus, select:focus { border-color: var(--accent); box-shadow: 0 0 10px rgba(0, 242, 255, 0.1); }
.btn { background: #181818; border: 1px solid #333; color: #ccc; padding: 11px; border-radius: 8px; font-size: 10px; cursor: pointer; text-transform: uppercase; letter-spacing: 1.5px; font-weight: 700; text-align: center; transition: 0.2s; }
.btn:hover { border-color: var(--accent); color: var(--accent); background: #222; }
.btn-accent { background: var(--accent); color: #000; border: none; }
.btn-accent:hover { background: #fff; color: #000; box-shadow: var(--glow); }
.btn-red { color: #ff5555; border-color: #552222; }
.btn-red:hover { background: #331111; border-color: #ff5555; }

input[type="range"] { -webkit-appearance: none; width: 100%; height: 4px; background: #333; border-radius: 2px; }
input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; width: 14px; height: 14px; background: var(--accent); border-radius: 50%; cursor: pointer; box-shadow: 0 0 10px var(--accent); }

/* Media Interface */
.window-frame { width: 92%; max-width: 1100px; height: 72vh; border-radius: var(--radius); overflow: hidden; border: 1px solid rgba(255,255,255,0.1); background: #000; display:flex; flex-direction: column; box-shadow: 0 30px 60px rgba(0,0,0,0.7); }
iframe { width: 100%; height: 100%; border: none; background: #000; flex-grow: 1; }
.media-bar { padding: 18px; background: #090909; border-top: 1px solid #222; display: flex; gap: 12px; }

/* Panic Overlays */
#panicBlank { position: fixed; inset: 0; background: #fff; z-index: 99999; display: none; }
#panicBSOD { position: fixed; inset: 0; background: #0000aa; color: #fff; font-family: monospace; z-index: 99999; display: none; padding: 60px; font-size: 21px; line-height: 1.6; }
</style>
</head>
<body class="custom-cursor">

<div id="cursor"><div class="dot"></div><div class="ring"></div></div>
<div class="vignette"></div>
<div class="scanline"></div>
<canvas id="particleCanvas"></canvas>

<div id="panicBlank"></div>
<div id="panicBSOD">
<p>A fatal exception 0E has occurred at 0028:C0034B23. The current application will be terminated.</p>
<p>* Press any key to terminate the current application.</p>
<p>* Press CTRL+ALT+DEL again to restart your computer. You will lose any unsaved information in all applications.</p>
<p>Press any key to continue _</p>
</div>

<div class="tab-bar">
<button class="tab active" onclick="app.switchTab('home', this)">HUB</button>
<button class="tab" onclick="app.switchTab('media', this)">MEDIA PLAYER</button>
</div>

<div class="widget-area">
<div id="widgetClock" class="clock">00:00</div>
<div id="widgetDate" class="date">LOADING...</div>
<div id="widgetGreet" class="greeting">Initialising...</div>
<div id="widgetSys" class="sys-stat">CPU: 0% RAM: 0GB</div>
</div>

<div id="home" class="view active">
<div class="search-container">
<i class="fas fa-terminal search-icon"></i>
<input type="text" class="search-bar" placeholder="Terminal Search..." oninput="app.filterGrid(this.value)">
</div>
<div class="grid-container">
<div class="grid" id="grid"></div>
</div>
</div>

<div id="media" class="view">
<div class="window-frame">
<iframe id="mediaFrame" src="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>
<div class="media-bar">
<input type="text" id="mediaInput" placeholder="Paste Spotify Track/Playlist or YouTube URL here..." style="flex-grow:1;">
<button class="btn btn-accent" style="width: 140px;" onclick="app.loadMedia()">LAUNCH</button>
</div>
</div>
</div>

<i class="fas fa-sliders-h sidebar-btn" onclick="document.getElementById('sidebar').classList.add('open')"></i>

<aside class="sidebar" id="sidebar">
<div class="sb-header">
<span class="sb-title">NEXORA // OMNI</span>
<i class="fas fa-times" style="cursor:pointer; color:#666;" onclick="document.getElementById('sidebar').classList.remove('open')"></i>
</div>

<div class="sb-content">
<details open>
<summary>Visual Themes</summary>
<div class="control-group">
<span class="row">Global Preset</span>
<select id="presetSel" onchange="app.applyTheme(this.value)">
<option value="cyberpunk">Cyberpunk (Neon)</option>
<option value="matrix">The Matrix (Digital)</option>
<option value="glacier">Glacier (Frost)</option>
<option value="inferno">Inferno (Ash)</option>
<option value="void">The Void (Stars)</option>
</select>
<div class="row"><span>Scanlines</span> <input type="checkbox" id="scanToggle" onchange="document.querySelector('.scanline').classList.toggle('active', this.checked); app.saveSetting('scan', this.checked)"></div>
<div class="row"><span>Accent Color</span> <input type="color" id="accentPick" style="width:40px; height:24px; border:none; background:none;" onchange="app.setAccent(this.value)"></div>
<div class="row"><span>Background Blur</span> <input type="range" min="0" max="40" value="12" oninput="app.setCSS('--glass-blur', this.value+'px')"></div>
</div>
</details>

<details>
<summary>Grid & Layout</summary>
<div class="control-group">
<div class="row"><span>Grid Columns</span> <input type="range" min="2" max="8" value="5" oninput="app.setCSS('--grid-cols', this.value)"></div>
<div class="row"><span>Edit Mode</span> <input type="checkbox" id="editToggle" onchange="app.editMode = this.checked; app.renderGrid(app.links)"></div>
<hr style="border:0; border-top:1px solid #222;">
<input type="text" id="newTitle" placeholder="App Title">
<input type="url" id="newUrl" placeholder="App URL">
<button class="btn btn-accent" onclick="app.addLink()">Add Shortcut</button>
<button class="btn btn-red" onclick="app.resetLinks()">Factory Reset Grid</button>
</div>
</details>

<details>
<summary>Particle Engine</summary>
<div class="control-group">
<div class="row"><span>Count</span> <input type="number" id="pCount" value="60" style="width:60px" onchange="particles.init()"></div>
<select id="pShape" onchange="particles.init()">
<option value="circle">Circles</option>
<option value="square">Squares</option>
<option value="matrix">Matrix Code</option>
<option value="star">Fixed Stars</option>
</select>
<div class="row"><span>Connect Lines</span> <input type="checkbox" id="pLine" onchange="particles.init()"></div>
<div class="row"><span>Parallax Speed</span> <input type="range" min="1" max="10" value="3" oninput="particles.speed = this.value/10"></div>
</div>
</details>

<details>
<summary>Stealth & Cloaking</summary>
<div class="control-group">
<select onchange="app.cloak(this.value)">
<option value="">-- Change Tab Appearance --</option>
<option value="google">Google Classroom</option>
<option value="canvas">Canvas LMS</option>
<option value="docs">Google Docs</option>
<option value="drive">Google Drive</option>
</select>
<div class="row"><span>Panic Key (F9)</span> <span style="color:var(--accent)">Active</span></div>
<select id="panicType">
<option value="bsod">Fake BSOD</option>
<option value="blank">White Screen</option>
<option value="google">Redirect to Google</option>
</select>
</div>
</details>

<details>
<summary>System & Data</summary>
<div class="control-group">
<div class="row"><span>24H Format</span> <input type="checkbox" id="clk24" checked></div>
<div class="row"><span>Fake Sys Stats</span> <input type="checkbox" id="statToggle" onchange="document.getElementById('widgetSys').style.display = this.checked ? 'block' : 'none'"></div>
<button class="btn" onclick="app.exportConfig()">Export Config (JSON)</button>
<button class="btn" onclick="document.getElementById('impFile').click()">Import Config</button>
<input type="file" id="impFile" style="display:none" onchange="app.importConfig(this)">
</div>
</details>

<div style="margin-top:20px; text-align:center; font-size:10px; color:#444; letter-spacing:2px;">NEXORA HUB OMNI v3.1</div>
</div>
</aside>

<script>
const defaultLinks = [
{ n: "Nexora", u: "https://mathematicss.global.ssl.fastly.net" },
{ n: "Luminal", u: "https://sciencea.global.ssl.fastly.net" },
{ n: "Hideout", u: "https://artsuplies.global.ssl.fastly.net" },
{ n: "Movies", u: "https://mrbeastisrich.global.ssl.fastly.net" },
{ n: "Roblox", u: "https://our-ddddd.global.ssl.fastly.net" },
{ n: "Interstellar", u: "https://interstellar.global.ssl.fastly.net" },
{ n: "Utopia", u: "https://utopia.global.ssl.fastly.net" },
{ n: "Nebula", u: "https://nebula.global.ssl.fastly.net" }
];

const app = {
links: [],
theme: 'cyberpunk',
editMode: false,

init: function() {
const savedLinks = localStorage.getItem('nx_links');
this.links = savedLinks ? JSON.parse(savedLinks) : defaultLinks;

this.loadSettings();
this.renderGrid(this.links);
this.initWidgets();
this.initCursor();
this.initPanic();
particles.init();
particles.loop();
},

renderGrid: function(list) {
const grid = document.getElementById('grid');
grid.innerHTML = '';
list.forEach((l, i) => {
const el = document.createElement('div');
el.className = 'box';
el.onclick = (e) => { if(!e.target.classList.contains('del-btn')) window.open(l.u, '_blank'); };

let ico = 'fa-globe';
const n = l.n.toLowerCase();
if(n.includes('movie') || n.includes('film')) ico = 'fa-film';
else if(n.includes('game') || n.includes('roblox')) ico = 'fa-gamepad';
else if(n.includes('math') || n.includes('calc')) ico = 'fa-calculator';
else if(n.includes('music') || n.includes('spotify')) ico = 'fa-music';

el.innerHTML = `
${this.editMode ? `<i class="fas fa-times-circle del-btn" onclick="app.deleteLink(${i})"></i>` : ''}
<i class="fas ${ico}"></i>
<span>${l.n}</span>
`;
grid.appendChild(el);
});
},

filterGrid: function(query) {
const filtered = this.links.filter(l => l.n.toLowerCase().includes(query.toLowerCase()));
this.renderGrid(filtered);
},

addLink: function() {
const n = document.getElementById('newTitle').value;
const u = document.getElementById('newUrl').value;
if(n && u) {
this.links.push({n, u});
this.saveLinks();
this.renderGrid(this.links);
document.getElementById('newTitle').value = '';
document.getElementById('newUrl').value = '';
}
},

deleteLink: function(i) {
this.links.splice(i, 1);
this.saveLinks();
this.renderGrid(this.links);
},

resetLinks: function() {
if(confirm('Wipe custom links and restore defaults?')) {
this.links = JSON.parse(JSON.stringify(defaultLinks));
this.saveLinks();
this.renderGrid(this.links);
}
},

// --- MEDIA SYSTEM (SPOTIFY FIX) ---
loadMedia: function() {
let val = document.getElementById('mediaInput').value.trim();
if(!val) return;

// Spotify Fix Logic
if (val.includes('open.spotify.com') && !val.includes('/embed')) {
val = val.replace('open.spotify.com/', 'open.spotify.com/embed/');
}
// YouTube Fix Logic
else if (val.includes('youtube.com/watch')) {
const vid = val.split('v=')[1].split('&')[0];
val = `https://www.youtube.com/embed/${vid}?autoplay=1`;
}
else if (val.includes('youtu.be/')) {
const vid = val.split('.be/')[1].split('?')[0];
val = `https://www.youtube.com/embed/${vid}?autoplay=1`;
}

document.getElementById('mediaFrame').src = val;
},

// --- THEME & UI ---
applyTheme: function(name) {
this.theme = name;
this.saveSetting('theme', name);
const r = document.documentElement;

const themes = {
cyberpunk: { bg: '#030303', acc: '#00f2ff', sec: '#ff0055', scan: true, shape: 'circle' },
matrix: { bg: '#000000', acc: '#00ff41', sec: '#008F11', scan: true, shape: 'matrix' },
glacier: { bg: '#050a14', acc: '#a6f0ff', sec: '#ffffff', scan: false, shape: 'circle' },
inferno: { bg: '#110500', acc: '#ff4d00', sec: '#ffaa00', scan: false, shape: 'circle' },
void: { bg: '#080808', acc: '#ffffff', sec: '#444', scan: false, shape: 'star' }
};

const t = themes[name];
r.style.setProperty('--bg', t.bg);
this.setAccent(t.acc);
r.style.setProperty('--sec-accent', t.sec);
document.getElementById('scanToggle').checked = t.scan;
document.querySelector('.scanline').classList.toggle('active', t.scan);
document.getElementById('pShape').value = t.shape;

particles.init();
},

setAccent: function(hex) {
document.documentElement.style.setProperty('--accent', hex);
document.documentElement.style.setProperty('--glow', `0 0 20px ${hex}44`);
document.getElementById('accentPick').value = hex;
this.saveSetting('accent', hex);
},

setCSS: function(k, v) { document.documentElement.style.setProperty(k, v); },

switchTab: function(id, btn) {
document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
document.getElementById(id).classList.add('active');
btn.classList.add('active');
},

cloak: function(type) {
const maps = {
google: { t: "Classes", i: "https://ssl.gstatic.com/classroom/favicon.png" },
canvas: { t: "Dashboard", i: "https://du11hjcvx0uqb.cloudfront.net/dist/images/favicon-e10d657a73.ico" },
docs: { t: "My Essay - Google Docs", i: "https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico" },
drive: { t: "My Drive - Google Drive", i: "https://ssl.gstatic.com/images/branding/product/1x/drive_2020q4_32dp.png" }
};
if(maps[type]) {
document.title = maps[type].t;
document.getElementById('siteIcon').href = maps[type].i;
}
},

initPanic: function() {
window.onkeydown = e => {
if(e.key === 'F9') {
const type = document.getElementById('panicType').value;
if(type === 'bsod') document.getElementById('panicBSOD').style.display = 'block';
else if(type === 'blank') document.getElementById('panicBlank').style.display = 'block';
else if(type === 'google') window.location.replace('https://google.com');
}
if(e.key === 'Escape') {
document.getElementById('panicBSOD').style.display = 'none';
document.getElementById('panicBlank').style.display = 'none';
}
};
},

triggerPanic: function() { // Manual trigger for button
const type = document.getElementById('panicType').value;
if(type === 'bsod') document.getElementById('panicBSOD').style.display = 'block';
else if(type === 'blank') document.getElementById('panicBlank').style.display = 'block';
else window.location.replace('https://google.com');
},

// --- WIDGETS ---
initWidgets: function() {
setInterval(() => {
const d = new Date();
const is24 = document.getElementById('clk24').checked;
document.getElementById('widgetClock').innerText = d.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit', hour12: !is24});
document.getElementById('widgetDate').innerText = d.toLocaleDateString([], {weekday:'long', month:'short', day:'numeric'});

const hr = d.getHours();
let greet = "System Online";
if(hr < 12) greet = "Good Morning, User";
else if(hr < 18) greet = "System Stabilized";
else greet = "Operational Night-Mode";
document.getElementById('widgetGreet').innerText = greet;

if(document.getElementById('statToggle').checked && Math.random() > 0.8) {
document.getElementById('widgetSys').innerText = `CPU: ${Math.floor(Math.random()*15 + 5)}% | RAM: ${(Math.random()*1.5 + 2.5).toFixed(1)}GB`;
}
}, 1000);
},

// --- DATA ---
saveLinks: function() { localStorage.setItem('nx_links', JSON.stringify(this.links)); },
saveSetting: function(k, v) { localStorage.setItem('nx_set_'+k, v); },
loadSettings: function() {
const theme = localStorage.getItem('nx_set_theme') || 'cyberpunk';
this.applyTheme(theme);
const acc = localStorage.getItem('nx_set_accent');
if(acc) this.setAccent(acc);
},

exportConfig: function() {
const config = { links: this.links, settings: localStorage };
const data = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(config));
const a = document.createElement('a');
a.href = data; a.download = 'nexora_hub_omni.json'; a.click();
},

importConfig: function(input) {
const reader = new FileReader();
reader.onload = e => {
const d = JSON.parse(e.target.result);
localStorage.setItem('nx_links', JSON.stringify(d.links));
location.reload();
};
reader.readAsText(input.files[0]);
},

initCursor: function() {
const c = document.getElementById('cursor');
window.onmousemove = e => {
c.style.left = e.clientX+'px'; c.style.top = e.clientY+'px';
if(!c.classList.contains('active')) c.classList.add('active');
};
document.body.classList.add('custom-cursor');
}
};

// --- PARTICLE ENGINE OMNI ---
const particles = {
cvs: null, ctx: null, items: [], speed: 0.3,
init: function() {
this.cvs = document.getElementById('particleCanvas');
this.ctx = this.cvs.getContext('2d');
this.cvs.width = window.innerWidth;
this.cvs.height = window.innerHeight;
this.items = [];
const count = document.getElementById('pCount').value;
const shape = document.getElementById('pShape').value;

for(let i=0; i<count; i++) {
this.items.push({
x: Math.random() * this.cvs.width,
y: Math.random() * this.cvs.height,
vx: (Math.random() - 0.5) * 2,
vy: shape === 'matrix' ? (Math.random() * 3 + 2) : (Math.random() - 0.5) * 2,
size: Math.random() * 3 + 1,
char: String.fromCharCode(0x30A0 + Math.random()*96)
});
}
},
loop: function() {
this.ctx.clearRect(0,0,this.cvs.width, this.cvs.height);
const accent = getComputedStyle(document.documentElement).getPropertyValue('--accent');
const shape = document.getElementById('pShape').value;
const connect = document.getElementById('pLine').checked;

this.ctx.fillStyle = accent;
this.ctx.strokeStyle = accent;

this.items.forEach((p, i) => {
if(shape !== 'star') {
p.x += p.vx * this.speed;
p.y += p.vy * this.speed;
}

if(p.x < 0) p.x = this.cvs.width; if(p.x > this.cvs.width) p.x = 0;
if(p.y < 0) p.y = this.cvs.height; if(p.y > this.cvs.height) p.y = 0;

this.ctx.globalAlpha = 0.5;
if(shape === 'matrix') {
this.ctx.font = '14px monospace';
this.ctx.fillText(p.char, p.x, p.y);
if(Math.random() > 0.98) p.char = String.fromCharCode(0x30A0 + Math.random()*96);
} else {
this.ctx.beginPath();
if(shape === 'circle' || shape === 'star') this.ctx.arc(p.x, p.y, p.size, 0, Math.PI*2);
else this.ctx.rect(p.x, p.y, p.size*2, p.size*2);
this.ctx.fill();
}

if(connect && shape !== 'matrix') {
this.items.forEach((p2, j) => {
if(i === j) return;
const d = Math.hypot(p.x-p2.x, p.y-p2.y);
if(d < 100) {
this.ctx.globalAlpha = (1 - d/100) * 0.2;
this.ctx.beginPath(); this.ctx.moveTo(p.x, p.y); this.ctx.lineTo(p2.x, p2.y); this.ctx.stroke();
}
});
}
});
requestAnimationFrame(() => this.loop());
}
};

window.onload = () => app.init();
window.onresize = () => particles.init();
</script>
</body>
</html>
